<% content_for :head do %>
  <meta http-equiv="refresh" content="3">
<% end %>
<div class="container">
  <div class="row">
    <div class="col-xs-10 col-xs-offset-1 col-sm-4 col-sm-offset-4">
      <% if policy(Question).create? %>
      <%= link_to "Poser une nouvelle question", new_question_path, class:"btn revote" %>
      <% end %>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12">
      <% @questions.order(cached_votes_up: :desc).each do |question|  %>
      <%= render "question", question: question %>
      <% end  %>
    </div>
  </div>
</div>
<% content_for :after_js do %>
  <script>
    App['dynamic_index'] = App.cable.subscriptions.create(
      { channel: 'DynamicIndexChannel'},
      { received: (data) => {
        console.log(data)
        }
      }
    )
  </script>
<% end %>
